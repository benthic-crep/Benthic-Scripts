rm(list=ls())
setwd("C:/Users/Courtney.S.Couch/Documents/GitHub/Benthic-Scripts/Photoquad Calibration")
library(gdata)             # needed for drop_levels()
library(reshape)           # reshape library inclues the cast() function used below
library(splitstackshape)
library(dplyr)
library(plyr)
library(tidyr)
#LOAD LIBRARY FUNCTIONS ...
source("C:/Users/Courtney.S.Couch/Documents/GitHub/Benthic-Scripts/Functions/Benthic_Functions_newApp_vTAOfork.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/core_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/fish_team_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/Islandwide Mean&Variance Functions.R")
cnet<-read.csv("OSBORNE_CalibrationTest.csv")
lu<-read.csv("T:/Benthic/Data/Lookup Tables/All_Photoquad_codes.csv")
cnet$SHORT_CODE<-cnet$Cnet_SHORT_CODE
head(cnet)
#Merge annotations and look up table then tweak column names
cnet<-left_join(cnet,lu)
nrow(cnet)
cnet$POINTS<-1
cnet$METHOD<-"CNET"
cnet$IMAGE<-cnet$Name
ab<-cnet #save as different data frame so you can go back to original dataframe before major tweaks
#CREATING CLASS EMA "Encrusting Macroalgae
levels(ab$TIER_1)<-c(levels(ab$TIER_1), "EMA")
levels(ab$T3_DESC)<-c(levels(ab$T3_DESC), "Encrusting macroalga")
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_1<-"EMA"
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_2<-"EMA"
###Create a Halimeda class
ab$TIER_3<-as.character(ab$TIER_3)
ab$TIER_1<-as.character(ab$TIER_1)
for (i in 1:nrow(ab)){ #opening brace
if(ab$TIER_3[i] =="HALI"){ #c&p
ab$TIER_1[i]="HALI" #c&p
} #c&p
} #closing curly brace for entire for loop
hal<-subset(ab,TIER_3=="HALI")
head(hal)
#Look at summary of data to check for major errors
ab<-droplevels(ab)
summary(ab)
#Check that all points have been annotated
all.tab2<-ddply(ab,.(Annotator,IMAGE),summarize,npoints=sum(POINTS))
miss.annot<-subset(all.tab2,npoints<10);miss.annot #This dataframe should be empty
#### NB THERE ARE SEVERAL UNCLASSIFIED CATEGORIES  THAT WILL NEED TO BE REMOVED PRIOR TO CALCULATING % COVER
UNIDENTIFIED_T1<-c("TW", "MF", "UC")
UNIDENTIFIED_T2<-c("MOBF", "TAPE", "UNK", "WAND", "SHAD")
length(unique(ab$SITE))
#Sum up all tier 1 points by ANNOTATOR. You need to use dcast to insert zero values where there was no coral at a site (for example)
photoT1<-as.data.frame(ab %>% group_by(Annotator, IMAGE,TIER_1) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
spread(TIER_1, n_points,fill=0))
head(ab)
as.data.frame(ab %>% group_by(Annotator, IMAGE,TIER_1) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE))
as.data.frame(ab %>% group_by(Annotator, IMAGE,TIER_1) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE))
)
as.data.frame(ab %>% group_by(Annotator, IMAGE,TIER_1) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
dplyr::spread(TIER_1, n_points,fill=0))
as.data.frame(ab %>% group_by(Annotator, IMAGE,TIER_1) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
plyr::spread(TIER_1, n_points,fill=0))
as.data.frame(ab %>% group_by(Annotator, IMAGE,TIER_1) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
tidyr::spread(TIER_1, n_points,fill=0))
rm(list=ls())
setwd("C:/Users/Courtney.S.Couch/Documents/Courtney's Files/R Files/ESD/BIA")
library(gdata)             # needed for drop_levels()
library(reshape)           # reshape library inclues the cast() function used below
library(splitstackshape)
library(dplyr)
library(plyr)
library(tidyr)
#LOAD LIBRARY FUNCTIONS ...
source("C:/Users/Courtney.S.Couch/Documents/GitHub/Benthic-Scripts/Functions/Benthic_Functions_newApp_vTAOfork.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/core_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/fish_team_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/Islandwide Mean&Variance Functions.R")
cnet<-read.csv("ASRAMP2018_CalibrationTest.csv")
lu<-read.csv("T:/Benthic/Data/Lookup Tables/All_Photoquad_codes.csv")
cnet$SHORT_CODE<-cnet$Cnet_SHORT_CODE
# Clean-up ----------------------------------------------------------------
#Merge annotations and look up table then tweak column names
cnet<-left_join(cnet,lu)
nrow(cnet)
cnet$POINTS<-1
cnet$METHOD<-"CNET"
cnet$IMAGE<-cnet$Name
ab<-cnet #save as different data frame so you can go back to original dataframe before major tweaks
#CREATING CLASS EMA "Encrusting Macroalgae
levels(ab$TIER_1)<-c(levels(ab$TIER_1), "EMA")
levels(ab$T3_DESC)<-c(levels(ab$T3_DESC), "Encrusting macroalga")
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_1<-"EMA"
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_2<-"EMA"
###Create a Halimeda class
ab$TIER_3<-as.character(ab$TIER_3)
ab$TIER_1<-as.character(ab$TIER_1)
for (i in 1:nrow(ab)){ #opening brace
if(ab$TIER_3[i] =="HALI"){ #c&p
ab$TIER_1[i]="HALI" #c&p
} #c&p
} #closing curly brace for entire for loop
hal<-subset(ab,TIER_3=="HALI")
head(hal)
#Look at summary of data to check for major errors
ab<-droplevels(ab)
summary(ab)
# QC ----------------------------------------------------------------------
#Check that all points have been annotated
all.tab2<-ddply(ab,.(Annotator,IMAGE),summarize,npoints=sum(POINTS))
miss.annot<-subset(all.tab2,npoints<10);miss.annot #This dataframe should be empty
#### NB THERE ARE SEVERAL UNCLASSIFIED CATEGORIES  THAT WILL NEED TO BE REMOVED PRIOR TO CALCULATING % COVER
UNIDENTIFIED_T1<-c("TW", "MF", "UC")
UNIDENTIFIED_T2<-c("MOBF", "TAPE", "UNK", "WAND", "SHAD")
length(unique(ab$SITE))
# GENERATE DATA AT ANNOTATOR LEVEL FOR TIER 1 CATEGORIES ------------------
#Sum up all tier 1 points by ANNOTATOR. You need to use dcast to insert zero values where there was no coral at a site (for example)
photoT1<-as.data.frame(ab %>% group_by(Annotator, IMAGE,TIER_1) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
spread(TIER_1, n_points,fill=0))
rm(list=ls())
setwd("C:/Users/Courtney.S.Couch/Documents/GitHub/Benthic-Scripts/Photoquad Calibration")
library(gdata)             # needed for drop_levels()
library(reshape)           # reshape library inclues the cast() function used below
library(splitstackshape)
library(dplyr)
library(plyr)
library(tidyr)
#LOAD LIBRARY FUNCTIONS ...
source("C:/Users/Courtney.S.Couch/Documents/GitHub/Benthic-Scripts/Functions/Benthic_Functions_newApp_vTAOfork.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/core_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/fish_team_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/Islandwide Mean&Variance Functions.R")
cnet<-read.csv("OSBORNE_CalibrationTest.csv")
lu<-read.csv("T:/Benthic/Data/Lookup Tables/All_Photoquad_codes.csv")
cnet$SHORT_CODE<-cnet$Cnet_SHORT_CODE
# Clean-up ----------------------------------------------------------------
#Merge annotations and look up table then tweak column names
cnet<-left_join(cnet,lu)
nrow(cnet)
cnet$POINTS<-1
cnet$METHOD<-"CNET"
cnet$IMAGE<-cnet$Name
ab<-cnet #save as different data frame so you can go back to original dataframe before major tweaks
#CREATING CLASS EMA "Encrusting Macroalgae
levels(ab$TIER_1)<-c(levels(ab$TIER_1), "EMA")
levels(ab$T3_DESC)<-c(levels(ab$T3_DESC), "Encrusting macroalga")
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_1<-"EMA"
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_2<-"EMA"
###Create a Halimeda class
ab$TIER_3<-as.character(ab$TIER_3)
ab$TIER_1<-as.character(ab$TIER_1)
for (i in 1:nrow(ab)){ #opening brace
if(ab$TIER_3[i] =="HALI"){ #c&p
ab$TIER_1[i]="HALI" #c&p
} #c&p
} #closing curly brace for entire for loop
hal<-subset(ab,TIER_3=="HALI")
head(hal)
#Look at summary of data to check for major errors
ab<-droplevels(ab)
summary(ab)
# QC ----------------------------------------------------------------------
#Check that all points have been annotated
all.tab2<-ddply(ab,.(Annotator,IMAGE),summarize,npoints=sum(POINTS))
miss.annot<-subset(all.tab2,npoints<10);miss.annot #This dataframe should be empty
#### NB THERE ARE SEVERAL UNCLASSIFIED CATEGORIES  THAT WILL NEED TO BE REMOVED PRIOR TO CALCULATING % COVER
UNIDENTIFIED_T1<-c("TW", "MF", "UC")
UNIDENTIFIED_T2<-c("MOBF", "TAPE", "UNK", "WAND", "SHAD")
length(unique(ab$SITE))
head(abbey)
head(ab)
ab %>% group_by(Annotator, IMAGE,TIER_1) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE))
ab %>% group_by(Annotator) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE))
ab %>% group_by(Annotator) %>%
summarise(n_points = sum(POINTS))
ab %>% dplyr::group_by(Annotator, IMAGE,TIER_1) %>%
dplyr::summarise(n_points = sum(POINTS, na.rm=TRUE))
photoT1<-as.data.frame(ab %>% dplyr::group_by(Annotator, IMAGE,TIER_1) %>%
dplyr::summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
spread(TIER_1, n_points,fill=0))
head(photoT1)
photoT1<-as.data.frame(ab %>% dplyr::group_by(Annotator, IMAGE,TIER_1) %>%
dplyr::summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
spread(TIER_1, n_points,fill=0))
photoT3<-as.data.frame(ab %>% dplyr::group_by(Annotator, IMAGE,TIER_3) %>%
dplyr::summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
spread(TIER_3, n_points,fill=0))
head(phtoT3)
head(photoT3)
rm(list=ls())
setwd("C:/Users/Courtney.S.Couch/Documents/GitHub/Benthic-Scripts/Photoquad Calibration")
library(gdata)             # needed for drop_levels()
library(reshape)           # reshape library inclues the cast() function used below
library(splitstackshape)
library(plyr)
library(dplyr)
library(tidyr)
#LOAD LIBRARY FUNCTIONS ...
source("C:/Users/Courtney.S.Couch/Documents/GitHub/Benthic-Scripts/Functions/Benthic_Functions_newApp_vTAOfork.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/core_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/fish_team_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/Islandwide Mean&Variance Functions.R")
cnet<-read.csv("OSBORNE_CalibrationTest.csv")
lu<-read.csv("T:/Benthic/Data/Lookup Tables/All_Photoquad_codes.csv")
cnet$SHORT_CODE<-cnet$Cnet_SHORT_CODE
# Clean-up ----------------------------------------------------------------
#Merge annotations and look up table then tweak column names
cnet<-left_join(cnet,lu)
nrow(cnet)
cnet$POINTS<-1
cnet$METHOD<-"CNET"
cnet$IMAGE<-cnet$Name
ab<-cnet #save as different data frame so you can go back to original dataframe before major tweaks
#CREATING CLASS EMA "Encrusting Macroalgae
levels(ab$TIER_1)<-c(levels(ab$TIER_1), "EMA")
levels(ab$T3_DESC)<-c(levels(ab$T3_DESC), "Encrusting macroalga")
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_1<-"EMA"
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_2<-"EMA"
###Create a Halimeda class
ab$TIER_3<-as.character(ab$TIER_3)
ab$TIER_1<-as.character(ab$TIER_1)
for (i in 1:nrow(ab)){ #opening brace
if(ab$TIER_3[i] =="HALI"){ #c&p
ab$TIER_1[i]="HALI" #c&p
} #c&p
} #closing curly brace for entire for loop
hal<-subset(ab,TIER_3=="HALI")
head(hal)
#Look at summary of data to check for major errors
ab<-droplevels(ab)
summary(ab)
# QC ----------------------------------------------------------------------
#Check that all points have been annotated
all.tab2<-ddply(ab,.(Annotator,IMAGE),summarize,npoints=sum(POINTS))
miss.annot<-subset(all.tab2,npoints<10);miss.annot #This dataframe should be empty
#### NB THERE ARE SEVERAL UNCLASSIFIED CATEGORIES  THAT WILL NEED TO BE REMOVED PRIOR TO CALCULATING % COVER
UNIDENTIFIED_T1<-c("TW", "MF", "UC")
UNIDENTIFIED_T2<-c("MOBF", "TAPE", "UNK", "WAND", "SHAD")
length(unique(ab$SITE))
# GENERATE DATA AT ANNOTATOR LEVEL FOR TIER 1 CATEGORIES ------------------
#Sum up all tier 1 points by ANNOTATOR. You need to use dcast to insert zero values where there was no coral at a site (for example)
photoT1<-as.data.frame(ab %>% group_by(Annotator, IMAGE,TIER_1) %>%
summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
spread(TIER_1, n_points,fill=0))
rm(list=ls())
setwd("C:/Users/Courtney.S.Couch/Documents/GitHub/Benthic-Scripts/Photoquad Calibration")
library(gdata)             # needed for drop_levels()
library(reshape)           # reshape library inclues the cast() function used below
library(splitstackshape)
library(plyr)
library(dplyr)
library(tidyr)
#LOAD LIBRARY FUNCTIONS ...
source("C:/Users/Courtney.S.Couch/Documents/GitHub/Benthic-Scripts/Functions/Benthic_Functions_newApp_vTAOfork.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/core_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/fish_team_functions.R")
source("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/lib/Islandwide Mean&Variance Functions.R")
cnet<-read.csv("OSBORNE_CalibrationTest.csv")
lu<-read.csv("T:/Benthic/Data/Lookup Tables/All_Photoquad_codes.csv")
cnet$SHORT_CODE<-cnet$Cnet_SHORT_CODE
# Clean-up ----------------------------------------------------------------
#Merge annotations and look up table then tweak column names
cnet<-left_join(cnet,lu)
nrow(cnet)
cnet$POINTS<-1
cnet$METHOD<-"CNET"
cnet$IMAGE<-cnet$Name
ab<-cnet #save as different data frame so you can go back to original dataframe before major tweaks
#CREATING CLASS EMA "Encrusting Macroalgae
levels(ab$TIER_1)<-c(levels(ab$TIER_1), "EMA")
levels(ab$T3_DESC)<-c(levels(ab$T3_DESC), "Encrusting macroalga")
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_1<-"EMA"
ab[ab$TIER_3 %in% c("LOBO","PESP", "EMA"),]$TIER_2<-"EMA"
###Create a Halimeda class
ab$TIER_3<-as.character(ab$TIER_3)
ab$TIER_1<-as.character(ab$TIER_1)
for (i in 1:nrow(ab)){ #opening brace
if(ab$TIER_3[i] =="HALI"){ #c&p
ab$TIER_1[i]="HALI" #c&p
} #c&p
} #closing curly brace for entire for loop
hal<-subset(ab,TIER_3=="HALI")
head(hal)
#Look at summary of data to check for major errors
ab<-droplevels(ab)
summary(ab)
# QC ----------------------------------------------------------------------
#Check that all points have been annotated
all.tab2<-ddply(ab,.(Annotator,IMAGE),summarize,npoints=sum(POINTS))
miss.annot<-subset(all.tab2,npoints<10);miss.annot #This dataframe should be empty
#### NB THERE ARE SEVERAL UNCLASSIFIED CATEGORIES  THAT WILL NEED TO BE REMOVED PRIOR TO CALCULATING % COVER
UNIDENTIFIED_T1<-c("TW", "MF", "UC")
UNIDENTIFIED_T2<-c("MOBF", "TAPE", "UNK", "WAND", "SHAD")
length(unique(ab$SITE))
# GENERATE DATA AT ANNOTATOR LEVEL FOR TIER 1 CATEGORIES ------------------
#Sum up all tier 1 points by ANNOTATOR. You need to use dcast to insert zero values where there was no coral at a site (for example)
photoT1<-as.data.frame(ab %>% dplyr::group_by(Annotator, IMAGE,TIER_1) %>%
dplyr::summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
spread(TIER_1, n_points,fill=0))
photoT3<-as.data.frame(ab %>% dplyr::group_by(Annotator, IMAGE,TIER_3) %>%
dplyr::summarise(n_points = sum(POINTS, na.rm=TRUE)) %>%
spread(TIER_3, n_points,fill=0))
df<-read.csv("C:/Users/Courtney.S.Couch/Documents/GitHub/fish-paste/data/Sectors-Strata-Areas.csv")
levels(df$SEC_NAME)
levels(as.factor(df$SEC_NAME))
View(levels(as.factor(df$SEC_NAME)))
